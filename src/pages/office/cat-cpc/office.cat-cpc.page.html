<ion-header>
  <ion-navbar hideBackButton>
    <ion-title>Office</ion-title>
    <ion-buttons end *ngIf="authenticationProvider.logoutEnabled()">
      <button ion-button (click)="logout()">Sign Out</button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content>
  <ion-row class="mes-full-width-card" id="candidate-section">
    <ion-col col-60>
      <h2 id="candidate-name">{{pageState.candidateName$ | async}}</h2>
      <h3 id="candidate-driver-number">{{pageState.candidateDriverNumber$ | async}}</h3>
    </ion-col>
    <ion-col col-36 class="align-col-right">
      <h2>{{pageState.startTime$ | async}}</h2>
      <h3>Test outcome:
        <div id="test-outcome-text" class="inline-mode" [ngSwitch]="(pageState.testOutcomeText$ | async)">
          <span class="pass" *ngSwitchCase="'Passed'">
            {{pageState.testOutcomeText$ | async}}
          </span>
          <span class="fail" *ngSwitchCase="'Unsuccessful'">
            {{pageState.testOutcomeText$ | async}}
          </span>
          <span class="terminated" *ngSwitchCase="'Terminated'">
            {{pageState.testOutcomeText$ | async}}
          </span>
        </div>
      </h3>
    </ion-col>
  </ion-row>

  <form [formGroup]="form">

    <ion-card>
      <ion-card-header>
        <h4>Test summary</h4>
      </ion-card-header>

      <ion-card-content class="card-content-ios" no-bounce no-padding>
        <ion-grid class="grid">
          <activity-code id="activity-code-card" [formGroup]="form"
                         [activityCodeModel]="pageState.activityCode$ | async"
                         [activityCodeOptions]="activityCodeOptions"
                         [disabled]="true">
          </activity-code>

          <div no-padding>

            <candidate-description [display]="pageState.displayCandidateDescription$ | async" [formGroup]="form"
                                   [candidateDescription]="pageState.candidateDescription$ | async"
                                   [outcome]="pageState.testOutcome$ | async"
                                   (candidateDescriptionChange)="candidateDescriptionChanged($event)">
            </candidate-description>

            <identification [display]="pageState.displayIdentification$ | async" [formGroup]="form"
                            [identification]="pageState.identification$ | async"
                            [outcome]="pageState.testOutcome$ | async"
                            (identificationChange)="identificationChanged($event)">
            </identification>

            <combination [combination]="pageState.combination$ | async"
                         [combinationAdditionalText]="getCombinationAdditionalText(combinationCode)">
            </combination>

            <additional-information [display]="pageState.displayAdditionalInformation$ | async"
                                    [additionalInformation]="pageState.additionalInformation$ | async"
                                    [formGroup]="form"
                                    [outcome]="pageState.testOutcome$ | async"
                                    (additionalInformationChange)="additionalInformationChanged($event)">
            </additional-information>

            <assessment-report *ngIf="displayIfFail(outcome)"
                               [assessmentReport]="pageState.assessmentReport$ | async"
                               [formGroup]="form"
                               (assessmentReportChange)="assessmentReportChanged($event)">
            </assessment-report>

            <cpc-debrief-card *ngIf="displayIfFail(outcome)"
                              [overallScore]="pageState.overallScore$ | async"
                              [question1]="pageState.question1$ | async"
                              [question2]="pageState.question2$ | async"
                              [question3]="pageState.question3$ | async"
                              [question4]="pageState.question4$ | async"
                              [question5]="pageState.question5$ | async"
                              [testOutcome]="outcome">
            </cpc-debrief-card>

          </div>
        </ion-grid>
      </ion-card-content>
    </ion-card>

    <div [hidden]="!keyboard.isOpen()" class="keyboard-space"></div>
  </form>
</ion-content>
<ion-footer>
  <ion-row class="mes-full-width-card box-shadow">
    <ion-col *ngIf="!(pageState.isRekey$ | async)">
      <button float-left id="defer-button" ion-button (click)="defer()">
        <h3>Save and continue later</h3>
      </button>
      <button float-right class="mes-primary-button padding-x-5" ion-button (click)="onSubmit()">
        <h3>Upload</h3>
      </button>
    </ion-col>
    <ion-col *ngIf="(pageState.isRekey$ | async)">
      <button id="reason-for-rekey" class="mes-primary-button padding-x-5 full-width" ion-button
              (click)="goToReasonForRekey()">
        <h3>Continue</h3>
      </button>
    </ion-col>
  </ion-row>
</ion-footer>
